<html>
<style>
h1 {
  text-align: center;
  font-size: 10em;
  animation: spin 4s infinite;
  position: absolute;
  left: 20%;
}
.spinning {
  animation: 2s spin infinite;
}
.hidden {
  display:none
}
.red .face {
  fill:red
}

@keyframes spin {
  0% {transform: translate(0, 0) rotate(0deg);}
  50% {transform: translate(1em, -1em) rotate(360deg);}
  100% {transform: translate(0, 0) rotate(0deg);}
}
</style>
<body>

<button onclick="make_cats()">play</button>
<p></p>
<svg width='200' height='300' class='hidden'>
  <circle class='face' cx='70' cy='95' r='50' style='stroke:black' />
	<circle cx="55" cy="80" r="5" stroke="black" fill="#339933"/>
	<circle cx="85" cy="80" r="5" stroke="black" fill="#339933"/>
	<g id="whiskers">
	   <line x1="75" y1="95" x2="135" y2="85" style="stroke: black;"/>
	   <line x1="75" y1="95" x2="135" y2="105" style="stroke: black;"/>
	</g>
	
	<use xlink:href="#whiskers" transform="scale(-1 1) translate(-140 0)"/>
	<polyline points="108 62,  90 10,  70 45,  50, 10,  32, 62"
   style="stroke: black; fill: none;" />
<!-- mouth -->
<polyline points="35 110, 45 120, 95 120, 105, 110"
    style="stroke: black; fill: none;" />
	<path d="M 75 90 L 65 90 A 5 10 0  0 0 75 90"
   style="stroke: black; fill: #ffcccc"/>
	

	
</svg>
  <script src='https://code.responsivevoice.org/responsivevoice.js'></script>

<script
  src="https://code.jquery.com/jquery-3.4.1.slim.js"
  integrity="sha256-BTlTdQO9/fascB1drekrDVkaKd9PkwBymMlHOiG+qLI="
  crossorigin="anonymous"></script>
<script>
const ATTS = ['red', 'spinning']
var cur_att;
var is_reversed;

var make_cats = function() {
	
	cur_att = Math.floor(Math.random()*ATTS.length)
	is_reversed = Math.random() < 0.5
	const text = "how many cats are "
		+ (is_reversed ? 'not ' : '')
		+ ATTS[cur_att] +"?"
	$('p').text(text)
	responsiveVoice.speak(text, "US English Female", {
		onend: function() {
		}
	})
  
    $('svg:gt(0)').remove()
	var num_cats = Math.floor(Math.random()*6)+1;
	for (var i=0;i<num_cats;i++) {
		$('svg').eq(0).clone().appendTo('body')
		.each(function(svg){
		    const $t = $(this)
		    $(this).removeClass('hidden');
			
			for (var att=0;att<ATTS.length;att++) {
				if (Math.random()<.5) $t.addClass(ATTS[att])
			}
		})
	}
}

function sound(s) {
    var snd = new Audio(s+".mp3")
    snd.play();
}

$('body').keyup(function(e){
	
	console.log(e.key)
	
	if (!/\d/.test(e.key)) return
	let answer = $('svg:visible').filter(function(svg){
		
		/*let match = true
		for (var att=0;att<ATTS.length;att++) {
			const haz = $(this).hasClass(ATTS[att])
		}*/
		var haz = $(this).hasClass(ATTS[cur_att])
		if (is_reversed) haz = !haz
		return haz
	}).length
	

	responsiveVoice.speak(''+e.key, "US English Male", {
	onend: function(){
		if (parseInt(e.key) === answer) {
		responsiveVoice.speak("That's right, " + answer, "US English Female", {
		onend: function(){
			make_cats()
		}})
		} else {
			responsiveVoice.speak("Good try, but that's wrong.", "US English Female")
		}
	}});

})
</script>

</body>

</html>
